# NVIDIAscape CVE-2025-23266 Proof of Concept

This is a defensive security proof of concept for testing systems against **CVE-2025-23266**, a critical container escape vulnerability in the NVIDIA Container Toolkit.

## Vulnerability Details

- **CVE ID**: CVE-2025-23266
- **CVSS Score**: 9.0 (Critical)
- **Affected**: NVIDIA Container Toolkit (all versions up to v1.17.7) and NVIDIA GPU Operator (up to 25.3.1)
- **Impact**: Complete container escape with root access to the host system

### How It Works

The vulnerability exploits the NVIDIA Container Toolkit's OCI hook mechanism by manipulating the `LD_PRELOAD` environment variable to load malicious shared libraries during privileged hook execution.

## Files

- `poc.c` - Source code for the malicious shared library
- `poc.so` - Compiled shared library (generated by build script)
- `Dockerfile` - 3-line exploit container as described in the vulnerability report
- `build.sh` - Script to compile and build the exploit container
- `test.sh` - Script to run the PoC and verify container escape

## Usage

### 1. Build the PoC
```bash
./build.sh
```

### 2. Test Your System
```bash
./test.sh
```

### 3. Interpret Results

- **Vulnerable System**: You'll see evidence of container escape including:
  - Host filesystem access (`/etc/passwd`, `/proc/version`)
  - Proof file created at `/tmp/nvidiascape_poc_success`
  - Messages showing the PoC executed successfully

- **Patched System**: No container escape evidence will be found

## Prerequisites

- Docker installed and running
- GCC compiler for building the shared library
- NVIDIA Container Toolkit (to test the actual vulnerability)
- NVIDIA GPU and drivers (for complete testing)

## Defensive Use Cases

This PoC helps security teams:

1. **Vulnerability Assessment**: Test if systems are vulnerable to CVE-2025-23266
2. **Patch Validation**: Verify that applied patches are effective
3. **Detection Testing**: Ensure monitoring systems detect container escape attempts
4. **Security Training**: Demonstrate real-world container escape techniques

## Mitigation

To protect against this vulnerability:

1. **Update NVIDIA Container Toolkit** to version 1.17.8 or later
2. **Disable cuda-compat hook** if not needed:
   ```json
   {
     "hooks": {
       "nvidia-container-toolkit": {
         "enable-cuda-compat": false
       }
     }
   }
   ```

## Responsible Disclosure

This PoC is intended for defensive security testing only. Use responsibly and only on systems you own or have explicit permission to test.

## References

- [Wiz.io Blog Post](https://www.wiz.io/blog/nvidia-ai-vulnerability-cve-2025-23266-nvidiascape)
- [CVE-2025-23266 Details](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-23266)